# ---------------------------------------------------------------------------------------------------------------------------------------------------"
# ---------------------------------------------------------------------------------------------------------------------------------------------------"
# ---------------------------------------------------------------------------------------------------------------------------------------------------"
# Install Script for Demo Assets
#
# V2.0 
#
# Â©2020 nikh@ch.ibm.com
#
# https://cloud.ibm.com/docs/cloud-pak-multicloud-management?topic=cloud-pak-multicloud-management-cf-getting-started
#
# ---------------------------------------------------------------------------------------------------------------------------------------------------"
# ---------------------------------------------------------------------------------------------------------------------------------------------------"
# ---------------------------------------------------------------------------------------------------------------------------------------------------"
# ---------------------------------------------------------------------------------------------------------------------------------------------------"

source ./99_config-global.sh

#set -eo pipefail
#trap "echo '${RED} Installation failed in $0${NC}'" ERR

# ---------------------------------------------------------------------------------------------------------------------------------------------------"
# ---------------------------------------------------------------------------------------------------------------------------------------------------"
# Do Not Edit Below
# ---------------------------------------------------------------------------------------------------------------------------------------------------"
# ---------------------------------------------------------------------------------------------------------------------------------------------------"



headerModuleFileBegin "Install Demo Assets" $0
          


# ------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# PREREQUISITES
# ------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        export SCRIPT_PATH=$(pwd)

    



# ------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Install Klusterlet
# ------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------------------------------------------------
header3Begin "Install Demo Assets" "rocket"


        checkAlreadyInstalled app=kubetoy default
        if [[ $ALREADY_INSTALLED == 1 ]];
        then
            __output "    ${RED}${cross}Demo Apps already installed! Skipping...${NC}"
            exit 0
        fi

      __output "   ---------------------------------------------------------------------------------------------------------------------------"
        __output "    ${rocket} Creating ${CYAN}Demo Applications${NC}"
        ./demo/create-apps.sh

        __output "   ---------------------------------------------------------------------------------------------------------------------------"
        __output "    ${rocket} Creating ${CYAN}Demo Policies${NC}" 
        ./demo/create-policies.sh

        __output "   ---------------------------------------------------------------------------------------------------------------------------"
        __output "    ${rocket} Creating ${CYAN}local Kubetoy${NC}" 
        kubectl apply -n default -f ./demo/APPS/kubetoy_all_in_one.yaml

header3End


headerModuleFileEnd "Install Demo Assets" $0

